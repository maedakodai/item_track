<!-- タブナビゲーション -->
<ul class="nav nav-pills nav-fill" id="itemTabs" role="tablist">
  <li class="nav-item">
    <a class="nav-link active" id="using-tab" data-bs-toggle="tab"  data-bs-target="#using" role="tab" aria-controls="using" aria-selected="true">使用中</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="recommended-tab" data-bs-toggle="tab" data-bs-target="#recommended" role="tab" aria-controls="recommended" aria-selected="false">交換推奨</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="completed-tab" data-bs-toggle="tab" data-bs-target="#completed" role="tab" aria-controls="completed" aria-selected="false">交換完了</a>
  </li>
</ul>

<!-- タブコンテンツ -->
<div class="tab-content" id="itemTabsContent">
  <div class="tab-pane fade show active" id="using" role="tabpanel" aria-labelledby="using-tab">
    <table class="table">
      <thead>
        <tr>
          <th>アイテム名</th>
          <th>開始日</th>
          <th>終了日</th>
          <th>経過日数</th>
          <th>残り日数</th>
          <th>操作</th>
        </tr>
      </thead>
      <tbody>
        <% @items.each do |item| %>
          <% if item.end_at.nil? || item.end_at > Date.today %>
            <tr>
              <td><%= item.name %></td>
              <td><%= item.start_at %></td>
              <td><%= item.end_at || 'N/A' %></td>
              <td><%= (Date.today - item.start_at).to_i %>日</td>
              <td><%= item.end_at ? (item.end_at - Date.today).to_i.to_s + '日' : 'N/A' %></td>
              <td>
                <%= link_to '詳細', item_path(item), class: "btn btn-small btn-info" %>
                <%= link_to '編集', edit_item_path(item), class: "btn btn-small btn-secondary" %> 
                <%= link_to '削除', item, method: :delete, data: { confirm: "本当に削除しますか？" }, class: "btn btn-small btn-danger" %>
              </td>
            </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>
  </div>

  <div class="tab-pane fade" id="recommended" role="tabpanel" aria-labelledby="recommended-tab">
    <table class="table">
      <thead>
        <tr>
          <th>アイテム名</th>
          <th>開始日</th>
          <th>終了日</th>
          <th>経過日数</th>
          <th>超過日数</th>
          <th>操作</th>
        </tr>
      </thead>
      <tbody>
        <% @items.each do |item| %>
          <% if item.end_at && item.end_at < Date.today %>
            <tr>
              <td><%= item.name %></td>
              <td><%= item.start_at %></td>
              <td><%= item.end_at %></td>
              <td><%= (Date.today - item.start_at).to_i %>日</td>
              <td><%= (Date.today - item.end_at).to_i %>日超過</td>
              <td>
                <%= link_to '詳細', item_path(item), class: "btn btn-small btn-info" %>
                <%= link_to '編集', edit_item_path(item), class: "btn btn-small btn-secondary" %> 
                <%= link_to '削除', item, method: :delete, data: { confirm: "本当に削除しますか？" }, class: "btn btn-small btn-danger" %>
              </td>
            </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
